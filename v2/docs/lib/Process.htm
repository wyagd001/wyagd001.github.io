<!DOCTYPE HTML>
<html lang="zh">
<head>
<title>进程函数列表 | AutoHotkey v2</title>
<meta name="description" content="This page lists functions for retrieving information about a process or for performing various operations on a process." />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/dark.css" rel="stylesheet" type="text/css" media="(prefers-color-scheme: dark)" id="dark_css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>进程函数</h1>

<p>用于检索信息, 或对进程执行各种操作的函数. 单击函数名查看详细信息.</p>
<table class="info">
    <tr>
        <th>函数</th>
        <th abbr="Descr">描述</th>
    </tr>
    <tr>
        <td><a href="ProcessClose.htm">ProcessClose</a></td>
        <td>强制关闭第一个匹配的进程.</td>
    </tr>
    <tr>
        <td><a href="ProcessExist.htm">ProcessExist</a></td>
        <td>检查指定的进程是否存在.</td>
    </tr>
    <tr>
        <td><a href="ProcessGetName.htm">ProcessGetName</a></td>
        <td>返回指定进程的名称.</td>
    </tr>
    <tr>
        <td><a href="ProcessGetName.htm">ProcessGetParent</a></td>
        <td>返回创建指定进程的进程 ID(PID).</td>
    </tr>
    <tr>
        <td><a href="ProcessGetName.htm">ProcessGetPath</a></td>
        <td>返回指定进程的路径.</td>
    </tr>
    <tr>
        <td><a href="ProcessSetPriority.htm">ProcessSetPriority</a></td>
        <td>更改第一个匹配进程的优先级.</td>
    </tr>
    <tr>
        <td><a href="ProcessWait.htm">ProcessWait</a></td>
        <td>等待指定的进程存在.</td>
    </tr>
    <tr>
        <td><a href="ProcessWaitClose.htm">ProcessWaitClose</a></td>
        <td>等待匹配进程关闭.</td>
    </tr>
</table>

<h2 id="Remarks">备注</h2>
<p><strong>进程列表:</strong> 虽然没有 <em>ProcessList</em> 函数, 但<a href="#ExList">示例 #1</a> 和<a href="#ExListCOM">示例 #2</a> 演示了如何通过 <a href="DllCall.htm">DllCall</a> 或 COM 检索进程.</p>

<h2 id="Related">相关</h2>
<p><a href="Run.htm">Run</a>, <a href="WinClose.htm">WinClose</a>, <a href="WinKill.htm">WinKill</a>, <a href="WinWait.htm">WinWait</a>, <a href="WinWaitClose.htm">WinWaitClose</a>, <a href="WinExist.htm">WinExist</a>, <a href="Win.htm">窗口函数</a></p>

<h2 id="Examples">示例</h2>

<div class="ex" id="ExList">
<p><a class="ex_number" href="#ExList"></a>显示通过 <a href="DllCall.htm">DllCall</a> 和 <a href="https://learn.microsoft.com/windows/win32/api/psapi/nf-psapi-enumprocesses">EnumProcesses</a> 获取的运行进程列表.</p>
<pre>MyGui := Gui()
LV := MyGui.Add("ListView", "w1300 r25", ["#", "PID", "Name", "Path"])
for Index, Proc in GetProcessList()
    LV.Add("", Index, Proc.PID, Proc.Name, Proc.Path)
LV.ModifyCol()
MyGui.Title := LV.GetCount() " Processes"
MyGui.Show()

GetProcessList(MaxProcs := 1024) {
    Arr := []  <em>; 用于存储进程信息的数组</em>
    DllCall("Psapi.dll\EnumProcesses"
        , "Ptr", Buf := Buffer(MaxProcs * 4)  <em>; 用于存储所有进程 ID 的缓冲</em>
        , "UInt", Buf.Size
        , "UIntP", &amp;ByteCnt := 0)  <em>; DllCall 返回的字节数</em>
    Loop (ByteCnt // 4) {
        PID := NumGet(Buf, (A_Index - 1) * 4, "UInt")
        try Arr.Push({
            Name: ProcessGetName(PID),
            Path: ProcessGetPath(PID),
            PID: PID
        })
    }
    return Arr
}</pre>
</div>

<div class="ex" id="ExListCOM">
<p><a class="ex_number" href="#ExListCOM"></a> 显示使用 COM 和 <a href="https://learn.microsoft.com/windows/win32/cimwin32prov/win32-process">Win32_Process</a> 获取的正在运行的进程列表.</p>
<pre>MyGui := Gui(, "Process List")
LV := MyGui.Add("ListView", "x2 y0 w400 h500", ["Process Name", "Command Line"])
for process in ComObjGet("winmgmts:").ExecQuery("Select * from Win32_Process")
    LV.Add("", process.Name, process.CommandLine)
MyGui.Show()</pre>
</div>

</body>
</html>