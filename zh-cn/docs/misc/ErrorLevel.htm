<!DOCTYPE HTML>
<html>
<head>
<title>ErrorLevel</title>
<meta http-equiv="content-type" content="text/html; charset=gb2312">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>

<body>
<h1>ErrorLevel</h1>

<p>这是表示一些命令执行成功与否的内置变量(有些命令不会改变 ErrorLevel 的值).值为 0 时通常表示成功, 而其他值一般表示失败. 您也可以自己设置 ErrorLevel 的值.</p>
<p>特别有意义的是 <a href="../commands/Run.htm">RunWait</a> 会把 ErrorLevel 设置为它所运行程序的退出代码. 大多数程序在成功完成时会产生退出代码零.</p>
<p>每个 <a href="Threads.htm">线程</a> 会保持它自己的 ErrorLevel 的值, 这意味着如果 <a href="Threads.htm">当前线程</a> 被其他线程中断, 那么当原始线程恢复时它仍会拥有它原来的 ErrorLevel 值, 而不是由中断线程设置的 ErrorLevel 值.</p>
<p>注意: 由于一些命令会设置大于 1 的 ErrorLevel 值, 所以最好不要检查 ErrorLevel 是否大于 1, 而是检查它是否等于零.</p>
<h3>示例</h3>
<pre class="NoIndent">WinWait, MyWindow, , 1
if ErrorLevel   <em>; 即既不是空值, 也不是零.</em>
    MsgBox, The window does not exist.
else
    MsgBox, The window exists.</pre>
</body>
</html>
